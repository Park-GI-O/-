# 산불 연기인식 모니터링 시스템

## 산불을 사전에 차단하기 위한 시스템의 플로우
![image](https://user-images.githubusercontent.com/76612325/231358905-adfd8c38-42bc-4df6-870e-297b7d5d45de.png)
- 산불이 커지 이전에 산림 지역을 모니터링하고 있는 CCTV와 저희가 개발한 모델을 연동시켜 초기에 연기를 인식해 산불 진압에 도움을 주는 시스템을 목표로 개발하였습니다.


## 산불 연기인식 모니터링 시스템의 필요
![image](https://user-images.githubusercontent.com/76612325/231359371-8913f396-13de-47a5-a440-8c7efe80b37e.png)
- 먼저 산림청의 2002년부터 2022년까지 20년간 연도별 산불피해 데이터를 확인하여 국내 산불피해 증가 추세와 산불에 대응하는 정부의 방안을 확인 할 수 있습니다. 먼저 그래프를 보시면 부분적으로는 산불 발생의 불규칙성을 보여주지만 전체적으로는 추세선을 따라 증가양상을 보이고 있습니다. 이러한 불규칙적 산불피해에 대비해 정부와 산림청은 2022 종합대책 발표에서 빅데이터 기반 예측시스템으로 산불 다발 지역의 출입 통제 강화와 노후한 산불 감시카메라 교체, 그리고 신형카메라 추가 설치를 진행할 것이라고 발표했습니다. 이렇듯, 산림 CCTV와 데이터에 기반한 정부의 산불 대응 정책에 영감을 얻어, 저희는 딥러닝 모델 기반 산불 모니터링 시스템을 구축하는 프로젝트를 시작하게 되었습니다.

- 구체적인 사례를 조사하기위해 산불발생률이 높고 산불대응 인프라가 잘 갖춰진 상위 3지역의 산불 발생 추이 또한 확인했습니다. 먼저 보시는 검은 그래프는 2002년 부터 2012년 간의 산불발생 누적건수입니다. 해당 기간동안, 경상북도의 산불 발생 건 수가 가장 높았고 뒤이어 강원도, 경기도 순이었습니다. 

- 하지만 이후 2013년부터 2022년까지 누적 산불발생건수가 경기도가 가장 높았습니다. 저희는 이러한 현상에 대해 조사를 해보았고 실제로 2012년부터 2022년까지 수도권 지역의 등산 레저 문화 발전 및 입산객이 증가했다는 사실을 확인하였습니다. 이후 저희는 산불발생률과 입산객 수의 관계를 면밀히 조사해보며 산불 발생원인을 파악해보았습니다.


## 산불 발생의 주요 원인
![image](https://user-images.githubusercontent.com/76612325/231359948-594b7207-9f7e-4e19-9442-29ed80f95568.png)
- 실제로 입산객이 산불의 가장 큰 원인인지  확인하기 위해 산림청의 2013년부터 2022년까지 10년간의 산불 발생 현황 데이터를 확인했습니다. 그리고 전체 원인 중 약 절반의 높은 비율로 입산자들 실화가 산불발생의 가장 큰 원인으로 확인되었습니다

- 구체적으로 오른쪽의 20년간 일별 입산객 수와 산불 발생은 더욱 뚜렷한 상관 관계를 보여주어 입산객이 산불발생의 주요원인임을 알게되었습니다. 이러한 입산객으로부터의 산불 예방을 위해 실제로 산림청의 22년도 K-산불방지 종합대책에선 산림 CCTV로 산불을 탐지 할 뿐 아니라 입산객 모니터링까지 수행하여 그들을 통제하는 임무를 수행하고 있다고 설명했습니다. 
이후 저희는 현장에서 현직자가 겪는 산불 모니터링의 어려움을 확인하기 위해 구청의 산불 모니터링 전문가와의 인터뷰를 진행하였습니다. 더불어, 이에 대한 구체적인 데이터를 다시 한번 확인하여 현재 산불 모니터링의 실질적인 개선점을 파악하고 이를 보완하기 위한 딥러닝 모델 개발을 착수하였습니다.

## 연기를 육안으로 판단하기 힘든 문제점
![image](https://user-images.githubusercontent.com/76612325/231360344-4d370b9d-bbb8-4955-9a0a-5dbc10c41892.png)
- 저희는 인터뷰를 통해 산불재난의 원인은 입산객이라는 사실을 또 한번 확인하였습니다. 그리고 현재 산불 모니터링의 어려움은 사람의 육안으로 연기를 판단해야하기 때문에, 언제 어디서 일어날지 모르는 불시의 화재에 대한 대비를 하기 어렵다는 점이 있었습니다. 마지막으로 현재 산림 CCTV의 제한된 성능 문제로 정밀 감식이 어려운 점이 있다고 설명했습니다.

- 다음은 작년 동해안 산불화재 때 CCTV로 모니터링된 산불 현장을 확인해보시겠습니다. 이처럼 현재의 CCTV 모니터링으로는 산불 연기, 구름 , 안개를 육안으로 구분하기 힘든점을 확인할 수 있습니다. 그래서 향후  딥러닝 모델로 이를 구별할 수 있는 기회 영역까지 확인 할 수 있었습니다.

- 이러한 결과를 통해 저희는 현재 비효율적인 CCTV 산불 모니터링 시스템 이란 프로젝트의  문제 설정을 할 수 있었고 이를 개선하기 위한 연기인식 모델 개발을 진행하게 되었습니다.

## 산림청 CCTV와 모델의 결합
![image](https://user-images.githubusercontent.com/76612325/231360572-b6c5e4ce-c9cf-4f11-bd83-31b78506b7e8.png)
- 다음은 산림청의 전국 CCTV 현황 데이터로 시각화된 산림 CCTV 히트맵입니다. 저희는 현재의 산림청 CCTV 인프라에 프로젝트의 딥러닝 모델이 탑재되었을 때 발생하는 시너지를 설명 할 수 있습니다.
먼저 지도를 보시다시피 산불에 가장 취약한 지역인 강원도 경기도 경상북도 순으로 산림CCTV가 가장 많이 설치되어있음을 확인하였습니다. 이러한 사실을 기반으로, 저희의 산불 시스템이 가장 필요할 것으로 예상되는 강원도와 경상북도를 중심으로 더욱 정밀한 조사를 해보았습니다.

- 강원도와 경북 일대를 관할하는 동부지방산림청에 따르면 산불 감시 장비는 1대당 10km, 약 3만 ha 면적의 산림 화재를 감시할 수 있어서 카메라가 전혀 부족하지는 않은 상황이라고 합니다. 만약 저희 딥러닝 연기인식 모델이 산림청의 서버에 탑재 된다면 이미 확보된 산림 CCTV를 통해 산불을 신속•정밀하게 감지하고, 해당 지역의 산림청과 소방청등 유관부서에 그 경보가 신속하게 전달되는 강력한 네트워크를 구축할 수 있음을 예상할 수 있습니다.


## 사전 학습 모델 VGG16 모델 선정
![image](https://user-images.githubusercontent.com/76612325/231360853-6a9b5648-d838-4a93-842c-b74dedeaad82.png)
- 다음은 본격적으로 산불 연기를 분류분석하는 저희의 딥러닝 모델을 소개합니다.
해당 모델은 VGG16 딥러닝 모델로 CNN 모델알고리즘이 베이스가 되어 발전된 모델입니다.  산불의 연기를 감식하는데 특화된 사전 학습 모델입니다.  또한 다른 이미지 분류 모델에 비해 사용하기 쉬운 구조와 좋은 성능을 가졌습니다. 그리고 하이퍼파라미터를 미세조정하는데 적합한 모델입니다.


## 학습 데이터 구성
![image](https://user-images.githubusercontent.com/76612325/231360938-2da06abb-0536-4e22-8855-ac0fad25c8ce.png)


## 모델링 과정
![image](https://user-images.githubusercontent.com/76612325/231361028-ddffb43a-8452-4e1c-9773-e13e939fff30.png)
![image](https://user-images.githubusercontent.com/76612325/231361083-6ecad88c-f3ca-40e3-ab61-7484ee363fba.png)
- 보시는 그래프와 같이 과대적합된 학습결과를 확인하였고 이를 보완하기 위해 다양한 방법으로 하이퍼파라미터 값의 미세조정을 진행하였습니다.

![image](https://user-images.githubusercontent.com/76612325/231361139-a0a6d496-1369-47ad-9359-519a5babd111.png)
![image](https://user-images.githubusercontent.com/76612325/231361163-274b9753-aa7b-49c6-856b-ee4f7ae5d883.png)
- 다음은 최종 85%의 학습 정확도를 만들어내기까지, 다양한 히든레이어 활용과, 하이퍼파라미터 조정 시도 끝에 완성된 최종 모델입니다.
모델의 성능을 올리기 위해서 최적의 하이퍼파라미터를 찾는 과정을 진행하였습니다. 
하이퍼 파라미터의 값의 리스트는 다음과 같이 설정했습니다. 모든 경우의 수에 대해서 모델이 학습해본 결과 batch size는 32, learning rate는 1e-5, epoch은 100이 저희 모델에 가장 좋은 결과를 보여주었습니다.


## 기대효과
![image](https://user-images.githubusercontent.com/76612325/231361295-08fe4f61-3af1-4b00-a9e3-201708299b02.png)
- 저희 서비스를 통해  불시의 화재를 감지하여 산불화재 진압이 가능하고 또한 산불 발생 장소, 규모를 신속히 파악하여 효과적 초동대응이 가능함 대규모 산불재난 발전 가능성을 대폭 감소할 수 있습니다. 산불발생 후 의심되는 입산객을 정밀하게 모니터링하여 사고 발생 후 원인 조사에 유리하고 모니터링에 필요한 인력을 줄여 예산 절감에 또한 유리합니다


## 발전 영역
![image](https://user-images.githubusercontent.com/76612325/231361671-dcbb1154-f5b2-41c2-a46a-96b0b077e141.png)
- 먼저 향후 저희 모델을 통해 강화학습을 실현할 수 있습니다. 다양한 산불 발화 데이터를 지속적 학습하면서 모델 성능 개선 기능을 하여 정확성과 속도를 개선할 수 있습니다.
또한 앞서 언급드렸듯 산불연기와 흡사한 구름, 안개, 인가의 굴뚝연기를 분류 구별할 수 있는 정밀 학습 알고리즘 연구 또한 가능합니다. 분류된 산불연기를 분석하여 화재 규모를 정리 요약 가능한 스마트 알람경보 시스템 또한 연계할 수 있고 마지막으로 야간에도 연기를 인식할 수 있도록 추가적인 학습 필요합니다


## 개발 후기
![image](https://user-images.githubusercontent.com/76612325/231362446-b7b42cdd-98a1-4af5-9172-bca156868ede.png)




